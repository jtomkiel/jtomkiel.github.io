<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.11.2 by Michael Rose
  Copyright 2013-2018 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Terminals - josh@blog:~$ cat README.txt</title>
<meta name="description" content="SANS Holiday Hack 2016 Writeup - The Terminals">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="josh@blog:~$ cat README.txt">
<meta property="og:title" content="Terminals">
<meta property="og:url" content="http://localhost:4000/sans/holday%20hack/writeup/sans-holiday-hack-terminals-2016/">


  <meta property="og:description" content="SANS Holiday Hack 2016 Writeup - The Terminals">



  <meta property="og:image" content="http://localhost:4000/assets/images/sans-2016.png">



  <meta name="twitter:site" content="@jtomkiel">
  <meta name="twitter:title" content="Terminals">
  <meta name="twitter:description" content="SANS Holiday Hack 2016 Writeup - The Terminals">
  <meta name="twitter:url" content="http://localhost:4000/sans/holday%20hack/writeup/sans-holiday-hack-terminals-2016/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="http://localhost:4000/assets/images/sans-2016.png">
    
  

  



  <meta property="article:published_time" content="2016-03-06T00:00:00-08:00">



  <meta property="article:modified_time" content="2016-03-06T10:56:50-08:00">



  

  


<link rel="canonical" href="http://localhost:4000/sans/holday%20hack/writeup/sans-holiday-hack-terminals-2016/">





  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "http://localhost:4000",
      "logo": "http://localhost:4000/assets/images/bio-photo.jpg"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Josh Tomkiel",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="josh@blog:~$ cat README.txt Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/">josh@blog:~$ cat README.txt</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/about/" >About</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/year-archive/" >Posts</a>
            </li>
          
        </ul>
        
        <button class="search__toggle" type="button">
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/bio-photo.jpg" alt="Josh Tomkiel" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Josh Tomkiel</h3>
    
    
      <p class="author__bio" itemprop="description">
        Information Security Professional
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">127.0.0.1</span>
        </li>
      

      

      
        <li>
          <a href="mailto:jtomkiel+blog@gmail.com">
            <meta itemprop="email" content="jtomkiel+blog@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      
        <li>
          <a href="https://twitter.com/jtomkiel" itemprop="sameAs">
            <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
        </li>
      

      

      

      
        <li>
          <a href="https://www.linkedin.com/in/jtomkiel" itemprop="sameAs">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Terminals">
    <meta itemprop="description" content="SANS Holiday Hack 2016 Writeup - The Terminals">
    <meta itemprop="datePublished" content="March 06, 2016">
    <meta itemprop="dateModified" content="March 06, 2016">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Terminals
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  16 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <h3 id="there-are-a-total-of-five-5-terminals-that-you-can-interact-with-while-playing-the-quest">There are a total of five (5) terminals that you can interact with while playing the <a href="https://quest2016.holidayhackchallenge.com">Quest</a>.</h3>

<p><img src="/assets/images/sans2016/terminal0_welcome.png" alt="terminal_icon" /></p>

<p>This year, the <a href="https://www.holidayhackchallenge.com/2016/">SANS Holiday Hack Challenge</a> included in game “terminals.” After collecting the parts below to build a Cranberry Pi and talking with the elf, Holly Evergreen, you can interact with the terminals.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">SD Card</th>
      <th style="text-align: center">Pi Board</th>
      <th style="text-align: left">HDMI Cord</th>
      <th style="text-align: left">Heatsink</th>
      <th style="text-align: left">Power Cord</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><img src="/assets/images/sans2016/sd_card.png" alt="sd_card" /></td>
      <td style="text-align: center"><img src="/assets/images/sans2016/pi_board.png" alt="pi_board" /></td>
      <td style="text-align: left"><img src="/assets/images/sans2016/hdmi.png" alt="hdmi" /></td>
      <td style="text-align: left"><img src="/assets/images/sans2016/heatsink.png" alt="heatsink" /></td>
      <td style="text-align: left"><img src="/assets/images/sans2016/power_cord.png" alt="power" /></td>
    </tr>
  </tbody>
</table>

<p>To interact with a terminal, simply walk up to one of these <img src="/assets/images/sans2016/terminal_icon.png" alt="terminal_icon" /> icons in the game.  You will be greeted with a command prompt on your own private <a href="https://www.docker.com/">Docker</a> container. This feature was awesome!  Each terminal presented its own challenge. Without further ado, let me walk you through how I completed each one.</p>

<h2 id="tcpdump-challenge">Tcpdump Challenge</h2>

<p><img src="/assets/images/sans2016/terminal_pcap_room.png" alt="image" /></p>

<h3 id="challenge-objective-get-both-parts-of-the-passphrase">Challenge Objective: Get Both Parts of the Passphrase</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">*******************************************************************************</span>
<span class="err">*</span>                                                                             <span class="err">*</span>
<span class="nv">*To</span> <span class="s">open the door, find both parts of the passphrase inside the /out.pcap file*</span> 
<span class="err">*</span>                                                                             <span class="err">*</span>
<span class="err">*******************************************************************************</span>
</code></pre></div></div>

<p>Let’s take a look at the default directory I was are placed in.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">ls -la</span>
<span class="s">total 1136</span>
<span class="s">drwxr-xr-x  46 root  root     4096 Dec 31 19:55 .</span>
<span class="s">drwxr-xr-x  46 root  root     4096 Dec 31 19:55 ..</span>
<span class="s">-rwxr-xr-x   1 root  root        0 Dec 31 19:55 .dockerenv</span>
<span class="s">drwxr-xr-x   2 root  root     4096 Dec  1 21:18 bin</span>
<span class="s">drwxr-xr-x   2 root  root     4096 Sep 12 04:09 boot</span>
<span class="s">drwxr-xr-x   5 root  root      380 Dec 31 19:55 dev</span>
<span class="s">drwxr-xr-x  46 root  root     4096 Dec 31 19:55 etc</span>
<span class="s">drwxr-xr-x   5 root  root     4096 Dec  7 20:22 home</span>
<span class="s">drwxr-xr-x  10 root  root     4096 Dec  1 21:18 lib</span>
<span class="s">drwxr-xr-x   2 root  root     4096 Nov  4 18:29 lib64</span>
<span class="s">drwxr-xr-x   2 root  root     4096 Nov  4 18:28 media</span>
<span class="s">drwxr-xr-x   2 root  root     4096 Nov  4 18:28 mnt</span>
<span class="s">drwxr-xr-x   2 root  root     4096 Nov  4 18:28 opt</span>
<span class="s">-r--------   1 itchy itchy 1087929 Dec  2 15:05 out.pcap</span>
<span class="s">dr-xr-xr-x 370 root  root        0 Dec 31 19:55 proc</span>
<span class="s">drwx------   2 root  root     4096 Nov  4 18:28 root</span>
<span class="s">drwxr-xr-x   3 root  root     4096 Nov  4 18:28 run</span>
<span class="s">drwxr-xr-x   2 root  root     4096 Nov  4 18:30 sbin</span>
<span class="s">drwxr-xr-x   2 root  root     4096 Nov  4 18:28 srv</span>
<span class="s">dr-xr-xr-x  13 root  root        0 Dec 14 14:13 sys</span>
<span class="s">drwxrwxrwt   2 root  root     4096 Dec  7 20:22 tmp</span>
<span class="s">drwxr-xr-x  15 root  root     4096 Dec  1 21:18 usr</span>
<span class="s">drwxr-xr-x  17 root  root     4096 Dec  2 15:13 var</span>
</code></pre></div></div>

<p>The file <code class="highlighter-rouge">out.pcap</code> is visible but it is owned by user “itchy”.  Our current user is “scratchy” and “scratchy” does not have rights to access it.</p>

<p>The <code class="highlighter-rouge">sudo</code> command will come in handy here.  I don’t know the passwords for either account but let’s see what other options there are with <code class="highlighter-rouge">sudo</code>.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">sudo -h</span>
<span class="s">sudo - execute a command as another user</span>
<span class="na">usage</span><span class="pi">:</span> <span class="s">sudo -h | -K | -k | -V</span>
<span class="na">usage</span><span class="pi">:</span> <span class="s">sudo -v [-AknS] [-g group] [-h host] [-p prompt] [-u user]</span>
<span class="na">usage</span><span class="pi">:</span> <span class="s">sudo -l [-AknS] [-g group] [-h host] [-p prompt] [-U user] [-u user] [command]</span>
<span class="na">usage</span><span class="pi">:</span> <span class="s">sudo [-AbEHknPS] [-r role] [-t type] [-C num] [-g group] [-h host] [-p prompt]</span>
            <span class="s">[-u user] [VAR=value] [-i|-s] [&lt;command&gt;]</span>
<span class="na">usage</span><span class="pi">:</span> <span class="s">sudo -e [-AknS] [-r role] [-t type] [-C num] [-g group] [-h host] [-p prompt]</span>
            <span class="s">[-u user] file ...</span>
<span class="na">Options</span><span class="pi">:</span>
  <span class="s">-A, --askpass               use a helper program for password prompting</span>
  <span class="s">-b, --background            run command in the background</span>
  <span class="s">-C, --close-from=num        close all file descriptors &gt;= num</span>
  <span class="s">-E, --preserve-env          preserve user environment when running command</span>
  <span class="s">-e, --edit                  edit files instead of running a command</span>
  <span class="s">-g, --group=group           run command as the specified group name or ID</span>
  <span class="s">-H, --set-home              set HOME variable to target user's home dir</span>
  <span class="s">-h, --help                  display help message and exit</span>
  <span class="s">-h, --host=host             run command on host (if supported by plugin)</span>
  <span class="s">-i, --login                 run login shell as the target user; a command may also be</span>
                              <span class="s">specified</span>
  <span class="s">-K, --remove-timestamp      remove timestamp file completely</span>
  <span class="s">-k, --reset-timestamp       invalidate timestamp file</span>
  <span class="s">-l, --list                  list user's privileges or check a specific command; use</span>
                              <span class="s">twice for longer format</span>
  <span class="s">-n, --non-interactive       non-interactive mode, no prompts are used</span>
  <span class="s">-P, --preserve-groups       preserve group vector instead of setting to target's</span>
  <span class="s">-p, --prompt=prompt         use the specified password prompt</span>
  <span class="s">-r, --role=role             create SELinux security context with specified role</span>
  <span class="s">-S, --stdin                 read password from standard input</span>
  <span class="s">-s, --shell                 run shell as the target user; a command may also be</span>
                              <span class="s">specified</span>
  <span class="s">-t, --type=type             create SELinux security context with specified type</span>
  <span class="s">-U, --other-user=user       in list mode, display privileges for user</span>
  <span class="s">-u, --user=user             run command (or edit file) as specified user name or ID</span>
  <span class="s">-V, --version               display version information and exit</span>
  <span class="s">-v, --validate              update user's timestamp without running a command</span>
  <span class="s">--                          stop processing command line arguments</span>
</code></pre></div></div>

<p>Let’s see if I can list the privileges that our current user (scratchy) has.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">sudo -l -U scratchy</span>
<span class="na">sudo</span><span class="pi">:</span> <span class="s">unable to resolve host fd1441e110fc</span>
<span class="na">Matching Defaults entries for scratchy on fd1441e110fc</span><span class="pi">:</span>
    <span class="s">env_reset, mail_badpass,</span>
    <span class="s">secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span>
<span class="na">User scratchy may run the following commands on fd1441e110fc</span><span class="pi">:</span>
    <span class="s">(itchy) NOPASSWD</span><span class="pi">:</span> <span class="s">/usr/sbin/tcpdump</span>
    <span class="s">(itchy) NOPASSWD</span><span class="pi">:</span> <span class="s">/usr/bin/strings</span>
</code></pre></div></div>

<p>The NOPASSWD setting is not great for security as it allows the command to be run without prompting for a password and it runs with the permissions of the owner.  In this case I can run a <code class="highlighter-rouge">sudo</code> command as “itchy” and have that account read the pcap with <code class="highlighter-rouge">tcpdump</code> and <code class="highlighter-rouge">strings</code>.  First, start by telling <code class="highlighter-rouge">tcpdump</code> to output in ASCII (-A) and read from a file (-r) then finally greping through that output to match words containing “part.” I chose to first look for “part” because the welcome banner said “<strong>find both parts</strong> of the passphrase inside the /out.pcap file.”</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">sudo -u itchy tcpdump -A -r out.pcap | grep 'part'</span>
<span class="na">sudo</span><span class="pi">:</span> <span class="s">unable to resolve host fd1441e110fc</span>
<span class="s">reading from file out.pcap, link-type EN10MB (Ethernet)</span>
<span class="s">&lt; input type="hidden" name="part1" value="santasli" /&gt;</span>
</code></pre></div></div>

<p>Nailed it.  Part 1 of the passphrase is <code class="highlighter-rouge">santasli</code>.</p>

<p>Part 2 can be found using <code class="highlighter-rouge">strings</code> command.  However, just running <code class="highlighter-rouge">strings</code> will not show the answer.  Let’s take a look at what options <code class="highlighter-rouge">strings</code> has.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">strings -h</span>
<span class="na">Usage</span><span class="pi">:</span> <span class="s">strings [option(s)] [file(s)]</span>
 <span class="s">Display printable strings in [file(s)] (stdin by default)</span>
 <span class="s">The options are</span><span class="pi">:</span>
  <span class="s">-a - --all                Scan the entire file, not just the data section [default]</span>
  <span class="s">-d --data                 Only scan the data sections in the file</span>
  <span class="s">-f --print-file-name      Print the name of the file before each string</span>
  <span class="s">-n --bytes=[number]       Locate &amp; print any NUL-terminated sequence of at</span>
  <span class="s">-&lt;number&gt;                   least [number] characters (default 4).</span>
  <span class="s">-t --radix={o,d,x}        Print the location of the string in base 8, 10 or 16</span>
  <span class="s">-w --include-all-whitespace Include all whitespace as valid string characters</span>
  <span class="s">-o                        An alias for --radix=o</span>
  <span class="s">-T --target=&lt;BFDNAME&gt;     Specify the binary file format</span>
  <span class="s">-e --encoding={s,S,b,l,B,L} Select character size and endianness</span><span class="pi">:</span>
                            <span class="s">s = 7-bit, S = 8-bit, {b,l} = 16-bit, {B,L} = 32-bit</span>
  <span class="err">@</span><span class="s">&lt;file&gt;                   Read options from &lt;file&gt;</span>
  <span class="s">-h --help                 Display this information</span>
  <span class="s">-v -V --version           Print the program's version number</span>
<span class="na">strings</span><span class="pi">:</span> <span class="na">supported targets</span><span class="pi">:</span> <span class="s">elf64-x86-64 elf32-i386 elf32-x86-64 a.out-i386-linux pei-i3</span>
<span class="s">86 pei-x86-64 elf64-l1om elf64-k1om elf64-little elf64-big elf32-little elf32-big pe-x86</span>
<span class="s">-64 pe-bigobj-x86-64 pe-i386 plugin srec symbolsrec verilog tekhex binary ihex</span>
<span class="s">Report bugs to &lt; http://www.sourceware.org/bugzilla/ &gt;</span>
</code></pre></div></div>

<p>By specifying the encoding character size as 16-bit (-el) the cleartext passphase for Part 2 can be seen!</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">sudo -u itchy strings -el out.pcap</span>
<span class="na">sudo</span><span class="pi">:</span> <span class="s">unable to resolve host fd1441e110fc</span>
<span class="s">part2:ttlehelper</span>
</code></pre></div></div>

<p>Complete passphase:  <code class="highlighter-rouge">santaslittlehelper</code></p>

<p>The two user accounts were “itchy” and “scratchy”, it’s nice to see that they kept with <a href="https://en.wikipedia.org/wiki/The_Simpsons">The Simpsons</a> theme…</p>

<p><img src="/assets/images/sans2016/Coin_tcpdump.png" alt="challenge_coin" /></p>

<h2 id="outatime-challenge">OUTATIME Challenge</h2>

<p><img src="/assets/images/sans2016/terminal_outtatime.png" alt="terminal" /></p>

<h3 id="challenge-objective--ride-the-train">Challenge Objective:  Ride the Train</h3>

<p>I had the most fun with this challenge.  The terminal opens to a preconfigured menu with limited options.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Train Management Console</span><span class="pi">:</span> <span class="s">AUTHORIZED USERS ONLY</span>
                <span class="s">==== MAIN MENU ====</span>
<span class="na">STATUS</span><span class="pi">:</span>                         <span class="s">Train Status</span>
<span class="na">BRAKEON</span><span class="pi">:</span>                        <span class="s">Set Brakes</span>
<span class="na">BRAKEOFF</span><span class="pi">:</span>                       <span class="s">Release Brakes</span>
<span class="na">START</span><span class="pi">:</span>                          <span class="s">Start Train</span>
<span class="na">HELP</span><span class="pi">:</span>                           <span class="s">Open the help document</span>
<span class="na">QUIT</span><span class="pi">:</span>                           <span class="s">Exit console</span>
<span class="s">menu:main&gt;</span> 
</code></pre></div></div>

<p>Type <code class="highlighter-rouge">HELP</code> and press enter.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">Help Document for the Train</span>

<span class="err">*</span><span class="nv">*STATUS</span><span class="err">**</span> <span class="s">option will show you the current state of the train (brakes, boiler, boiler temp, coal level)</span>

<span class="err">*</span><span class="nv">*BRAKEON</span><span class="err">**</span> <span class="s">option enables the brakes.  Brakes should be enabled at every stop and while the train is not in use.</span>

<span class="err">*</span><span class="nv">*BRAKEOFF</span><span class="err">**</span> <span class="s">option disables the brakes.  Brakes must be disabled before the **START** command will execute.</span>

<span class="err">*</span><span class="nv">*START</span><span class="err">**</span> <span class="s">option will start the train if the brake is released and the user has the correct password.</span>

<span class="err">*</span><span class="nv">*HELP</span><span class="err">**</span> <span class="s">brings you to this file.  If it's not here, this console cannot do it, unLESS you know something I don't.</span>

<span class="s">Just in case you wanted to know, here's a really good Cranberry pie recipe</span><span class="pi">:</span>

<span class="s">Ingredients</span>
<span class="s">1 recipe pastry for a 9 inch double crust pie</span>
<span class="s">1 1/2 cups white sugar</span>
<span class="s">1/3 cup all-purpose flour</span>
<span class="s">1/4 teaspoon salt</span>
<span class="s">1/2 cup water</span> 
<span class="s">1 (12 ounce) package fresh cranberries</span>
<span class="s">1/4 cup lemon juice</span>
<span class="s">1 dash ground cinnamon</span>
<span class="s">2 teaspoons butter</span>
<span class="pi">:</span>
</code></pre></div></div>

<p>Seeing the <code class="highlighter-rouge">:</code> at the bottom of the file immediately reminded me of a past SANS blog post about <a href="https://pen-testing.sans.org/blog/2012/06/06/escaping-restricted-linux-shells">Escaping Restricted Linux Shells</a>.  To escape this and access a shell prompt, simply put an exclamation mark (<code class="highlighter-rouge">!</code>) and press enter.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Train Management Console</span><span class="pi">:</span> <span class="s">AUTHORIZED USERS ONLY</span>
                <span class="s">==== MAIN MENU ====</span>
<span class="na">STATUS</span><span class="pi">:</span>                         <span class="s">Train Status</span>
<span class="na">BRAKEON</span><span class="pi">:</span>                        <span class="s">Set Brakes</span>
<span class="na">BRAKEOFF</span><span class="pi">:</span>                       <span class="s">Release Brakes</span>
<span class="na">START</span><span class="pi">:</span>                          <span class="s">Start Train</span>
<span class="na">HELP</span><span class="pi">:</span>                           <span class="s">Open the help document</span>
<span class="na">QUIT</span><span class="pi">:</span>                           <span class="s">Exit console</span>
<span class="s">menu:main&gt; HELP</span>
<span class="s">sh-4.3$</span> 
</code></pre></div></div>

<p>Now I have a shell.  A quick <code class="highlighter-rouge">ls -la</code> will show the other files in the current directory.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">sh-4.3$ ls -la</span>
<span class="s">total 40</span>
<span class="s">drwxr-xr-x 2 conductor conductor  4096 Dec 10 19:39 .</span>
<span class="s">drwxr-xr-x 6 root      root       4096 Dec 10 19:39 ..</span>
<span class="s">-rw-r--r-- 1 conductor conductor   220 Nov 12  2014 .bash_logout</span>
<span class="s">-rw-r--r-- 1 conductor conductor  3515 Nov 12  2014 .bashrc</span>
<span class="s">-rw-r--r-- 1 conductor conductor   675 Nov 12  2014 .profile</span>
<span class="s">-rwxr-xr-x 1 root      root      10528 Dec 10 19:36 ActivateTrain</span>
<span class="s">-rw-r--r-- 1 root      root       1506 Dec 10 19:36 TrainHelper.txt</span>
<span class="s">-rwxr-xr-x 1 root      root       1588 Dec 10 19:36 Train_Console</span>
<span class="s">sh-4.3$</span> 
</code></pre></div></div>

<p>To activate the train, all I need to do is run <code class="highlighter-rouge">./ActivateTrain</code> and I will be transported back to 1978.</p>

<p>Santa is hiding out in this area too.</p>

<p><img src="/assets/images/sans2016/Coin_time_travel.png" alt="challenge_coin" /></p>

<p>Back to the future!</p>

<p><img src="/assets/images/sans2016/terminal_1978.png" alt="challenge_coin" /></p>

<p>One last thing, if you view the <code class="highlighter-rouge">Train_Console</code> script, you can see how the game sends a user back in time.</p>

<p>To test if I could send another user back in time, I quickly created a second account, collected the Cranberry Pi parts required and logged into this terminal on a different browser.  Here is the output of the original <code class="highlighter-rouge">Train_Console</code> script.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">sh-4.3$ cat Train_Console</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/bin/bash</span>
<span class="s">HOMEDIR="/home/conductor"</span>
<span class="s">CTRL="$HOMEDIR/"</span>
<span class="s">DOC="$HOMEDIR/TrainHelper.txt"</span>
<span class="s">PAGER="less"</span>
<span class="s">BRAKE="on"</span>
<span class="s">PASS="24fb3e89ce2aa0ea422c3d511d40dd84"</span>
<span class="s">print_header() {</span>
        <span class="s">echo ""</span>
        <span class="s">echo "Train Management Console</span><span class="pi">:</span> <span class="s">AUTHORIZED USERS ONLY"</span>
        <span class="s">echo ""</span>
<span class="err">}</span>

<span class="s">print_main_menu() {</span>
        <span class="s">echo ""</span>
        <span class="s">echo "                  ==== MAIN MENU ===="</span>
        <span class="s">echo ""</span>
        <span class="s">echo "STATUS</span><span class="pi">:</span>                   <span class="s">Train Status"</span>
        <span class="s">echo "BRAKEON</span><span class="pi">:</span>                  <span class="s">Set Brakes"</span>
        <span class="s">echo "BRAKEOFF</span><span class="pi">:</span>                 <span class="s">Release Brakes"</span>
        <span class="s">echo "START</span><span class="pi">:</span>                    <span class="s">Start Train"</span>
        <span class="s">echo "HELP</span><span class="pi">:</span>                     <span class="s">Open the help document"</span>
        <span class="s">echo "QUIT</span><span class="pi">:</span>                     <span class="s">Exit console"</span>
        <span class="s">echo ""</span>
        <span class="s">echo -n "menu:main&gt; "</span>
<span class="err">}</span>

<span class="c1"># MAIN</span>

<span class="s">trap "exit" SIGHUP SIGINT SIGTERM SIGQUIT</span>

<span class="s">print_header</span>

<span class="s">while(true); do</span>
        <span class="s">print_main_menu</span>
        <span class="s">read ARG</span>
        <span class="s">echo ""</span>

        <span class="s">if [[ ! $ARG ]] ; then</span>
                <span class="s">echo "Please select an number"</span>
                <span class="s">continue</span>
        <span class="s">fi</span>
        <span class="s">case "$ARG" in</span>
                <span class="s">STATUS)</span>
                        <span class="s">echo "Brake</span><span class="pi">:</span>                            <span class="s">$BRAKE"</span>
                        <span class="s">echo "BoilerOn</span><span class="pi">:</span>                         <span class="s">Yes"</span>
                        <span class="s">echo "BoilerTemp</span><span class="pi">:</span>                       <span class="s">Normal"</span>
                        <span class="s">echo "Coal Capacity Level</span><span class="pi">:</span>              <span class="s">97%"</span>
                        <span class="s">echo "FluxCapacitor</span><span class="pi">:</span>                    <span class="s">Fluxing"</span>
                        <span class="s">echo "Top Speed</span><span class="pi">:</span>                        <span class="s">88mph"</span>
                        <span class="s">;;</span>
                <span class="s">BRAKEON)</span>
                        <span class="s">sleep 1</span>
                        <span class="s">BRAKE="on"</span>
        <span class="s">echo "QUIT</span><span class="pi">:</span>                             <span class="s">Exit console"</span>
                        <span class="s">echo "The brake has been applied."</span>
                        <span class="s">echo $BRAKE</span>
                        <span class="s">;;</span>
                <span class="s">BRAKEOFF)</span>
                        <span class="s">sleep 1</span>
                        <span class="s">BRAKE="off"</span>
                        <span class="s">echo "*******CAUTION*******"</span>
                        <span class="s">echo "The brake has been released!"</span>
                        <span class="s">echo "*******CAUTION*******"</span>
                        <span class="s">echo $BRAKE</span>
                        <span class="s">;;</span>
                <span class="s">START)</span>
                        <span class="s">echo  "Checking brakes...."</span>
                        <span class="s">sleep 3</span>
                        <span class="s">if [ $BRAKE == "on" ] ; then</span>
                                <span class="s">echo "Brake must be off to start the train."</span>
                        <span class="s">else</span>
                                <span class="s">read -s -p "Enter Password</span><span class="pi">:</span> <span class="s2">"</span><span class="nv"> </span><span class="s">password</span>
                                <span class="s">[</span><span class="nv"> </span><span class="s">"$password" == "$PASS" ] &amp;&amp; QUEST_UID=$QUEST_UID ./ActivateTrain || echo "Access denied"</span>
                        <span class="s">fi</span>
                        <span class="s">continue</span>
                        <span class="s">;;</span>
                <span class="s">HELP) $PAGER $DOC</span>
                        <span class="s">;;</span>
                <span class="s">QUIT) echo "Exiting" ; exit</span>
                        <span class="s">;;</span>
        <span class="s">esac</span>
<span class="s">done</span>
</code></pre></div></div>

<p>Running the <code class="highlighter-rouge">env</code> command will print out the environmental variables which includes your unique <code class="highlighter-rouge">QUEST_UID</code> value.</p>

<p>My Primary Account:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">sh-4.3$ env</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">HOSTNAME=2a3d1803b361</span>
<span class="s">TERM=xterm</span>
<span class="s">QUEST_UID=4152024d099e6dfa4649f7016a860dxxxxxxxxx</span>  <span class="c1"># redacted</span>
<span class="s">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span>
<span class="s">_=/usr/bin/env</span>
<span class="s">PWD=/home/conductor</span>
<span class="s">HOME=/home/conductor</span>
<span class="s">SHLVL=12</span>
</code></pre></div></div>

<p>My Test Account:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">sh-4.3$ env</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">HOSTNAME=64fd641742ec</span>
<span class="s">TERM=xterm</span>
<span class="s">QUEST_UID=35ca097769d78a92364e3caff3cb75xxxxxxxxxx</span>  <span class="c1"># redacted</span>
<span class="s">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span>
<span class="s">_=/usr/bin/env</span>
<span class="s">PWD=/home/conductor</span>
<span class="s">SHLVL=3</span>
<span class="s">HOME=/home/conductor</span>
</code></pre></div></div>

<p>In my primary account, I made a copy of the <code class="highlighter-rouge">Train_Console</code> script and called it <code class="highlighter-rouge">TC1</code>.  I modified the <code class="highlighter-rouge">PASS="24fb3e89ce2aa0ea422c3d511d40dd84"</code> value to be simply <code class="highlighter-rouge">123</code> to save from typing that long original password, set the <code class="highlighter-rouge">BREAK="Off"</code> and finally changed the <code class="highlighter-rouge">QUEST_UID=$QUEST_UID</code> to be the hardcoded <code class="highlighter-rouge">QUEST_UID=35ca097769d78a92364e3caff3cb75xxxxxxxxx</code> of my test account.</p>

<p>Executed the script <code class="highlighter-rouge">./TC1</code> then typed <code class="highlighter-rouge">START</code> and pressed enter.  My test account was sent back in time!  Fortunately there is enough entropy in the <code class="highlighter-rouge">QUEST_UID</code> value that I don’t see people sending random users back to 1978.  If you could social engineer someone in to giving you their <code class="highlighter-rouge">QUEST_UID</code> value, you could send them back in time.</p>

<p><strong>Although I’m sure this goes against the terms of service and I do not recommend anyone doing this!</strong></p>

<h2 id="wumpus-challenge">Wumpus Challenge</h2>

<p><img src="/assets/images/sans2016/terminal1_workshop_wumpus.png" alt="terminal" /></p>

<h3 id="challenge-objective--kill-the-wumpus">Challenge Objective:  Kill the Wumpus</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">*******************************************************************************</span>
<span class="err">*</span>                                                                             <span class="err">*</span>
<span class="err">*</span> <span class="s">Find the passphrase from the wumpus.  Play fair or "cheat"; it's up to you. *</span> 
<span class="err">*</span>                                                                             <span class="err">*</span>
<span class="err">*******************************************************************************</span>
</code></pre></div></div>

<p>I started the game and successfully killed the Wumpus on the first try.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">./wumpus</span>
<span class="s">Instructions? (y-n) n</span>
<span class="s">You're in a cave with 20 rooms and 3 tunnels leading from each room.</span>
<span class="s">There are 3 bats and 3 pits scattered throughout the cave, and your</span>
<span class="s">quiver holds 5 custom super anti-evil Wumpus arrows.  Good luck.</span>
<span class="s">You are in room 2 of the cave, and have 5 arrows left.</span>
<span class="nv">*sniff</span><span class="err">*</span> <span class="s">(I can smell the evil Wumpus nearby!)</span>
<span class="s">There are tunnels to rooms 5, 7, and 19.</span>
<span class="s">Move or shoot? (m-s) s19</span>

<span class="nv">*thwock</span><span class="kt">!*</span> <span class="nv">*groan</span><span class="err">*</span> <span class="nv">*crash</span><span class="err">*</span>
<span class="s">A horrible roar fills the cave, and you realize, with a smile, that you</span>
<span class="s">have slain the evil Wumpus and won the game!  You don't want to tarry for</span>
<span class="s">long, however, because not only is the Wumpus famous, but the stench of</span>
<span class="s">dead Wumpus is also quite well known, a stench plenty enough to slay the</span>
<span class="s">mightiest adventurer at a single whiff!!</span>
<span class="na">Passphrase</span><span class="pi">:</span>
<span class="s">WUMPUS IS MISUNDERSTOOD</span>
</code></pre></div></div>

<p>Passphrase: <code class="highlighter-rouge">WUMPUS IS MISUNDERSTOOD</code></p>

<p>This is great! I completed the challenge and obtained the passphase.  However, the challenge banner stated that it was possible to cheat and I wanted to know how to do so.  I ran strings on the <code class="highlighter-rouge">wumpus</code> file but when nothing jumped out at me, I turned to the Internet and found what seems the be the <a href="https://github.com/vattam/BSDGames/blob/master/wump/wump.c">original source code</a> for the game “wump.”  I wasn’t sure how much the source code had been modified in our version but at least it gave me an idea of what the game’s logic could be.</p>

<p>I also noticed that lines 791-795 seem to be command line arguments but I wasn’t sure what they did yet.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">{</span>
 <span class="nv">(void)fprintf(stderr</span><span class="pi">,</span>
 <span class="s2">"</span><span class="s">usage:</span><span class="nv"> </span><span class="s">wump</span><span class="nv"> </span><span class="s">[-h]</span><span class="nv"> </span><span class="s">[-a</span><span class="nv"> </span><span class="s">arrows]</span><span class="nv"> </span><span class="s">[-b</span><span class="nv"> </span><span class="s">bats]</span><span class="nv"> </span><span class="s">[-p</span><span class="nv"> </span><span class="s">pits]</span><span class="nv"> </span><span class="s">[-r</span><span class="nv"> </span><span class="s">rooms]</span><span class="nv"> </span><span class="s">[-t</span><span class="nv"> </span><span class="s">tunnels]</span><span class="se">\n</span><span class="s">"</span><span class="nv">);</span>
 <span class="nv">exit(1);</span>
<span class="pi">}</span>
</code></pre></div></div>

<p>Digging a little deeper I found an explanation for those options in an <a href="https://web.archive.org/web/20090214233010/http://linux.die.net/man/6/wump">archived wumpus man page</a> thanks to <img src="https://web.archive.org" alt="web.archive.org" />.</p>

<p><img src="/assets/images/sans2016/wumpus_man.png" alt="wumpus_man" /></p>

<p>Let’s create a cave with only 6 rooms (-r 6) for the Wumpus to hide and 100 arrows (-a 100) instead of the default 20 rooms and 5 arrows. I like my odds…</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">./wumpus -r 6 -a 100</span>
<span class="s">Instructions? (y-n) n</span>
<span class="s">You're in a cave with 6 rooms and 3 tunnels leading from each room.</span>
<span class="s">There are 3 bats and 3 pits scattered throughout the cave, and your</span>
<span class="s">quiver holds 100 custom super anti-evil Wumpus arrows.  Good luck.</span>
<span class="s">You are in room 6 of the cave, and have 100 arrows left.</span>
<span class="nv">*rustle</span><span class="err">*</span> <span class="nv">*rustle</span><span class="err">*</span> <span class="s">(must be bats nearby)</span>
<span class="nv">*whoosh</span><span class="err">*</span> <span class="s">(I feel a draft from some pits).</span>
<span class="nv">*sniff</span><span class="err">*</span> <span class="s">(I can smell the evil Wumpus nearby!)</span>
<span class="s">There are tunnels to rooms 1, 4, and 5.</span>
<span class="s">Move or shoot? (m-s) s1</span>

<span class="nv">*whoosh</span><span class="err">*</span> <span class="s">(I feel a draft from some pits).</span>
<span class="nv">*sniff</span><span class="err">*</span> <span class="s">(I can smell the evil Wumpus nearby!)</span>
<span class="s">There are tunnels to rooms 1, 4, and 5.</span>
<span class="s">Move or shoot? (m-s) s2</span>

<span class="nv">*thunk</span><span class="err">*</span>  <span class="s">The arrow can't find a way from 6 to 2 and flys randomly</span>
<span class="s">into room 4!</span>
<span class="s">You are in room 6 of the cave, and have 98 arrows left.</span>
<span class="nv">*rustle</span><span class="err">*</span> <span class="nv">*rustle</span><span class="err">*</span> <span class="s">(must be bats nearby)</span>
<span class="nv">*whoosh</span><span class="err">*</span> <span class="s">(I feel a draft from some pits).</span>
<span class="nv">*sniff</span><span class="err">*</span> <span class="s">(I can smell the evil Wumpus nearby!)</span>
<span class="s">There are tunnels to rooms 1, 4, and 5.</span>
<span class="s">Move or shoot? (m-s) s3</span>

<span class="nv">*thunk</span><span class="err">*</span>  <span class="s">The arrow can't find a way from 6 to 3 and flys randomly</span>
<span class="s">into room 5!</span>
<span class="nv">*thwock</span><span class="kt">!*</span> <span class="nv">*groan</span><span class="err">*</span> <span class="nv">*crash</span><span class="err">*</span>
<span class="s">A horrible roar fills the cave, and you realize, with a smile, that you</span>
<span class="s">have slain the evil Wumpus and won the game!  You don't want to tarry for</span>
<span class="s">long, however, because not only is the Wumpus famous, but the stench of</span>
<span class="s">dead Wumpus is also quite well known, a stench plenty enough to slay the</span>
<span class="s">mightiest adventurer at a single whiff!!</span>
<span class="na">Passphrase</span><span class="pi">:</span>
<span class="s">WUMPUS IS MISUNDERSTOOD</span>
<span class="s">Care to play another game? (y-n)</span> 
</code></pre></div></div>

<p>Now that’s what I’m talking about.</p>

<p><img src="/assets/images/sans2016/Coin_WUMPUS.png" alt="challenge_coin" /></p>

<h2 id="doormat-challenge">Doormat Challenge</h2>

<p><img src="/assets/images/sans2016/terminal2_workshop_passphrase_cat_door.png" alt="terminal" /></p>

<h3 id="challenge-objective--find-the-hidden-passphrase">Challenge Objective:  Find the Hidden Passphrase</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">*******************************************************************************</span>
<span class="err">*</span>                                                                             <span class="err">*</span>
<span class="err">*</span> <span class="s">To open the door, find the passphrase file deep in the directories.         *</span> 
<span class="err">*</span>                                                                             <span class="err">*</span>
<span class="err">*******************************************************************************</span>
</code></pre></div></div>

<p>Passwords (passphrases) are typically found in text files, so I’ll see if I can find any .txt files first.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">$ find / -name *.txt</span>
<span class="s">/home/elf/.doormat/. / /\/\\/Don't Look Here!/You are persistent, aren't you?/'/key_for_the_door.txt</span>
</code></pre></div></div>

<p>Now that the location for the key is known, I just have to get to it.  It’s not as straightforward as simply changing to that directory and viewing the file. Certain characters need to be escaped.  Escaping is a method of quoting single characters. The escape (<code class="highlighter-rouge">\</code>) preceding a character tells the shell to interpret that character literally.</p>

<p>Here is a one liner with each character being escaped.  Running this command will print out the passphrase:</p>

<p><code class="highlighter-rouge">cat "/home/elf/.doormat/. / /\/\\\\/""Don't Look Here"'!'""/"You are persistent, aren't you?"/"'"/"key_for_the_door.txt"</code></p>

<p>Which prints out:  <code class="highlighter-rouge">key: open_sesame</code></p>

<p>Or you can achieve the same thing manually browsing directory by directory…</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /home/elf/
<span class="nb">ls</span> <span class="nt">-la</span>  <span class="c"># to see all directories including hidden ones </span>
<span class="nb">cd</span> .doormat
<span class="nb">ls</span> <span class="nt">-la</span>  <span class="c"># to see all directories including hidden ones </span>
<span class="nb">cd</span> <span class="s2">". /"</span>
<span class="nb">ls</span> <span class="nt">-la</span>  <span class="c"># to see all directories including hidden ones </span>
<span class="nb">cd</span> <span class="s2">" "</span>
<span class="nb">ls</span> <span class="nt">-la</span>  <span class="c"># to see all directories including hidden ones </span>
<span class="nb">cd</span> <span class="s2">"</span><span class="se">\\</span><span class="s2">"</span>
<span class="nb">ls</span> <span class="nt">-la</span>  <span class="c"># to see all directories including hidden ones </span>
<span class="nb">cd</span> <span class="se">\\\\</span>
<span class="nb">ls</span> <span class="nt">-la</span>  <span class="c"># to see all directories including hidden ones </span>
<span class="nb">cd</span> <span class="s2">"Don't Look Here!"</span>
<span class="nb">ls</span> <span class="nt">-la</span>  <span class="c"># to see all directories including hidden ones </span>
<span class="nb">cd</span> <span class="s2">"You are persistent, aren't you?"</span>
<span class="nb">ls</span> <span class="nt">-la</span>  <span class="c"># to see all directories including hidden ones </span>
<span class="nb">cd</span> <span class="s2">"'"</span>
<span class="nb">ls</span> <span class="nt">-la</span>  <span class="c"># to see all directories including hidden ones </span>
<span class="nb">cat </span>key_for_the_door.txt
key: open_sesame
</code></pre></div></div>

<p><img src="/assets/images/sans2016/Coin_doormat_challenge.png" alt="coin" /></p>

<h2 id="war-games-challenge">War Games Challenge</h2>

<p><img src="/assets/images/sans2016/terminal_santa_office.png" alt="wargames" /></p>

<h3 id="challenge-objective--start-a-global-thermonuclear-war">Challenge Objective:  Start a Global Thermonuclear War</h3>

<p>To win this challenge, you need to enter the dialog from the 1983 movie <a href="https://en.wikipedia.org/wiki/WarGames">WarGames</a>. It has to be EXACT.  Now you can watch the <a href="https://www.youtube.com/watch?v=KXzNo0vR_dU">movie clips on YouTube</a> and type it manually or use the <a href="https://github.com/abs0/wargames/blob/master/wargames.sh">wargames.sh</a> script found on GitHub.  That script will almost get you past this challenge with one exception, line 216 says “Later. Lets play Global Thermonuclear War.” It should be “Later. Let’s play Global Thermonuclear War.”</p>

<p>The text in ALL CAPTIALS is from the terminal.  The text in lowercase is what I entered.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GREETINGS PROFESSOR FALKEN.

Hello.

HOW ARE YOU FEELING TODAY?

I'm fine. How are you?

EXCELLENT.  IT'S BEEN A LONG TIME.  CAN YOU EXPLAIN
THE REMOVAL OF YOUR USER ACCOUNT NUMBER ON 6/23/73?

People sometimes make mistakes.

YES THEY DO.  SHALL WE PLAY A GAME?

Love to. How about Global Thermonuclear War?

WOULDN'T YOU PREFER A GOOD GAME OF CHESS?

Later. Let's play Global Thermonuclear War.

FINE

     WHICH SIDE DO YOU WANT?
  1.   UNITED STATES
  2.   SOVIET UNION
      PLEASE CHOOSE ONE:
2

PLEASE LIST PRIMARY TARGETS BY
CITY AND/OR COUNTY NAME:

Las Vegas

LAUNCH INITIATED, HERE'S THE KEY FOR YOUR TROUBLE: 
LOOK AT THE PRETTY LIGHTS
Press Enter To Continue

`LOOK AT THE PRETTY LIGHTS` is the passphase to enter The Corridor hidden behind Santa's bookshelf.
</code></pre></div></div>

<p>Passphase is <code class="highlighter-rouge">LOOK AT THE PRETTY LIGHTS</code></p>

<p><img src="/assets/images/sans2016/Coin_wargames.png" alt="coin" /></p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#holday-hack" class="page__taxonomy-item" rel="tag">Holday Hack</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#sans" class="page__taxonomy-item" rel="tag">SANS</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#writeup" class="page__taxonomy-item" rel="tag">writeup</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2016-03-06">March 06, 2016</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=jtomkiel&text=Terminals%20http%3A%2F%2Flocalhost%3A4000%2Fsans%2Fholday%2520hack%2Fwriteup%2Fsans-holiday-hack-terminals-2016%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fsans%2Fholday%2520hack%2Fwriteup%2Fsans-holiday-hack-terminals-2016%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http%3A%2F%2Flocalhost%3A4000%2Fsans%2Fholday%2520hack%2Fwriteup%2Fsans-holiday-hack-terminals-2016%2F" class="btn btn--google-plus" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Google Plus"><i class="fab fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fsans%2Fholday%2520hack%2Fwriteup%2Fsans-holiday-hack-terminals-2016%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/sans/holday%20hack/writeup/sans-holiday-hack-challenge-pt5-2016/" class="pagination--pager" title="Part 5: Discombobulated Audio
">Previous</a>
    
    
      <a href="/research/research-project1-2018/" class="pagination--pager" title="Research Project 1
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/500x300.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/research/research-project1-2018/" rel="permalink">Research Project 1
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Coming soon…
</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/sans-2016.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/sans/holday%20hack/writeup/sans-holiday-hack-challenge-pt5-2016/" rel="permalink">Part 5: Discombobulated Audio
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">SANS Holiday Hack 2016 Writeup - The Challenges - Part 5
</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/sans-2016.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/sans/holday%20hack/writeup/sans-holiday-hack-challenge-pt4-2016/" rel="permalink">Part 4: My Gosh… It’s Full of Holes
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  22 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">SANS Holiday Hack 2016 Writeup - The Challenges - Part 4
</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/sans-2016.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/sans/holday%20hack/writeup/sans-holiday-hack-challenge-pt3-2016/" rel="permalink">Part 3: A Fresh-Baked Holiday Pi
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  4 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">SANS Holiday Hack 2016 Writeup - The Challenges - Part 3
</p>
  </article>
</div>
        
      </div>
    </div>
  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="search-searchbar"></div>
    <div class="search-hits"></div></div>
      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/jtomkiel"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
    
    
    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Josh Tomkiel. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.0.13/js/all.js"></script>


<!-- Including InstantSearch.js library and styling -->
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch-theme-algolia.min.css">

<script>
// Instanciating InstantSearch.js with Algolia credentials
const search = instantsearch({
  appId: '',
  apiKey: '',
  indexName: '',
  searchParameters: {
    restrictSearchableAttributes: [
      'title',
      'content'
    ]
  }
});

const hitTemplate = function(hit) {
  const url = hit.url;
  const title = hit._highlightResult.title.value;
  const content = hit._highlightResult.html.value;

  return `
    <div class="list__item">
      <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
        <h2 class="archive__item-title" itemprop="headline"><a href="${url}">${title}</a></h2>
        <div class="archive__item-excerpt" itemprop="description">${content}</div>
      </article>
    </div>
  `;
}

// Adding searchbar and results widgets
search.addWidget(
  instantsearch.widgets.searchBox({
    container: '.search-searchbar',
    poweredBy: true,
    placeholder: 'Enter your search term...'
  })
);
search.addWidget(
  instantsearch.widgets.hits({
    container: '.search-hits',
    templates: {
      item: hitTemplate
    }
  })
);

// Starting the search
search.start();
</script>





  </body>
</html>